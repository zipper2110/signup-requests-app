# signup-requests-app

### Структура приложения

Основа - Spring Boot Maven app. 
Использовал Java 8 с Lombok, т. к. код заглушек на PasteBin содержал чуток lombok-магии.

Для persistence - in-memory H2 база, используется JPA. Для работы с данными - 
стандартный CrudRepository. 

Данные из front-end принимаются в rest controller, который инкапсулирует в себя 
подробности того, что взаимодействие происходит через HTTP API.  

Основная логика взаимодействий находится в сервисе. Сервис знает о действии 
"создание заявки на регистрацию" и выполняет сценарий по работе с заявкой
после её поступления.

### Отправка заявки на подтверждение

На реализацию реального использования брокера сообщений не хватило времени, поэтому 
использовал классы-заглушки. Вектор дальнейшей работы тут - прикрутить 
нужную реализацию (собирался подключить RabbitMQ). Также было бы удобнее использовать
неблокирующее асинхронное получение сообщений, тут в спринге есть вспомогательные 
средства, чтобы удобно подписаться на получение сообщений по нужному топику.

#### Отказоустойчивость

Проблема отказоустойчивости решена не полностью. В поле status мы храним текущее
состояние заявки, и когда приходит ответ, меняем статус. 
Сейчас делается 3 попытки получить сообщение-ответ об одобрении. В случае, если 
нам не удастся дождаться одобрения (например, в случае серьёзных проблем с 
доступностью сервиса), заявка "повиснет" - никогда не будет одобрена. 

Решением здесь было бы:
1) подписываться на получение сообщения с нужным message id асинхронно - тогда мы 
получим результат проверки заявки через любое время. 
2) сохранять id отправленного сообщения в БД и обновлять статус нужной заявки по id 
сообщения - так мы сможем корректно обновить статус заявки даже если наш сервис 
перезапустился после отправки запроса на одобрение

### Тестирование

Не хватило времени на нормальное покрытие тестами. 
 
Я понимаю, как работать с тестами, понимаю их место в процессе разработки 
и в обеспечении качества приложения. 
На текущей работе эти подходы не очень развиты, поэтому ещё
есть чему поучиться.

### На что ещё не хватило времени

- на реализацию формы. Планировал хотя бы на чём-то типа jsp сделать форму, которая 
бы дёргала контроллер.
- на реализацию нормальных ответов от контроллера и покрытия разных corner-case, 
начиная от хорошего тела ответа, заканчивая валидацией с сообщениями
- на тесты :(. Печаль, что не успел написать больше